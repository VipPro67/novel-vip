<h2 mat-dialog-title>{{isEditing ? 'Edit' : 'Create'}} Novel</h2>
<form [formGroup]="novelForm" (ngSubmit)="onSubmit()">
  <mat-dialog-content>
    <div class="form-fields">
      <mat-form-field>
        <mat-label>Title</mat-label>
        <input matInput formControlName="title" required (blur)="generateSlug()">
        <mat-error *ngIf="novelForm.get('title')?.hasError('required')">Title is required</mat-error>
        <mat-error *ngIf="novelForm.get('title')?.hasError('minlength')">Title must be at least 3 characters</mat-error>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Slug</mat-label>
        <input matInput formControlName="slug" required>
        <mat-error *ngIf="novelForm.get('slug')?.hasError('required')">Slug is required</mat-error>
        <mat-error *ngIf="novelForm.get('slug')?.hasError('pattern')">Invalid slug format (use lowercase letters, numbers, and hyphens)</mat-error>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Author</mat-label>
        <input matInput formControlName="author" required>
        <mat-error *ngIf="novelForm.get('author')?.hasError('required')">Author is required</mat-error>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Description</mat-label>
        <textarea matInput formControlName="description" rows="4" required></textarea>
        <mat-error *ngIf="novelForm.get('description')?.hasError('required')">Description is required</mat-error>
        <mat-error *ngIf="novelForm.get('description')?.hasError('minlength')">Description must be at least 10 characters</mat-error>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Cover Image URL</mat-label>
        <input matInput formControlName="coverImage" required>
        <mat-error *ngIf="novelForm.get('coverImage')?.hasError('required')">Cover image URL is required</mat-error>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Status</mat-label>
        <mat-select formControlName="status" required>
          <mat-option *ngFor="let status of statuses" [value]="status">
            {{status}}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="novelForm.get('status')?.hasError('required')">Status is required</mat-error>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Categories</mat-label>
        <mat-select formControlName="categories" multiple required>
          <mat-option *ngFor="let category of categories" [value]="category">
            {{category}}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="novelForm.get('categories')?.hasError('required')">At least one category is required</mat-error>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Genres</mat-label>
        <mat-chip-grid #genreList>
          <mat-chip *ngFor="let genre of novelForm.get('genres')?.value" [removable]="true" (removed)="removeGenre(genre)">
            {{genre}}
            <mat-icon matChipRemove>cancel</mat-icon>
          </mat-chip>
          <input placeholder="Add genre..."
                 [matChipInputFor]="genreList"
                 [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                 (matChipInputTokenEnd)="addGenre($event)">
          </mat-chip-grid>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Tags</mat-label>
        <mat-chip-grid #tagList>
          <mat-chip *ngFor="let tag of novelForm.get('tags')?.value" [removable]="true" (removed)="removeTag(tag)">
            {{tag}}
            <mat-icon matChipRemove>cancel</mat-icon>
          </mat-chip>
          <input placeholder="Add tag..."
                 [matChipInputFor]="tagList"
                 [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                 (matChipInputTokenEnd)="addTag($event)">
          </mat-chip-grid>
      </mat-form-field>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button type="button" (click)="onCancel()">Cancel</button>
    <button mat-raised-button color="primary" type="submit" [disabled]="!novelForm.valid">
      {{isEditing ? 'Update' : 'Create'}}
    </button>
  </mat-dialog-actions>
</form> 